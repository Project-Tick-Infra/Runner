{% extends 'base.html.twig' %}

{% block title %}Roadmap - Project Tick{% endblock %}

{% block body %}
<div class="hero-section" style="padding: 100px 0; background: var(--pt-black-900); text-align: center; color: white;">
    <div class="container">
        <h1 style="font-size: 4rem; margin-bottom: 24px;">Project Roadmap</h1>
        <p class="lead" style="font-size: 1.5rem; color: #D2D2D2; max-width: 800px; margin: 0 auto;">Our journey toward building the ultimate software development ecosystem.</p>
    </div>
</div>

<div class="py-5" style="background: var(--pt-white);">
    <div class="container">
        <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 32px; align-items: flex-start;">
            
            {# Planned Column #}
            <div class="roadmap-column">
                <h2 style="font-size: 1.5rem; border-bottom: 4px solid var(--pt-gray-200); padding-bottom: 12px; margin-bottom: 24px; color: var(--pt-black);">Planned</h2>
                {% for item in items|filter(i => i.status == 'planned') %}
                    <div class="card" style="margin-bottom: 24px; border-left: 4px solid var(--pt-gray-200); position: relative;">
                        <h4 style="margin: 0; color: var(--pt-black);">{{ item.title }}</h4>
                        {% if item.description %}
                            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 12px; margin-bottom: 0;">{{ item.description }}</p>
                        {% endif %}

                        <div style="margin-top: 16px; display: flex; align-items: center; justify-content: space-between;">
                            <div style="font-size: 0.85rem; color: #888; display: flex; align-items: center; gap: 4px;">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
                                <span>{{ item.votes|length }} votes</span>
                            </div>
                            
                            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                                <form action="{{ path('app_roadmap_vote', {id: item.id}) }}" method="POST" style="margin: 0;">
                                    {% set has_voted = app.user in item.votes %}
                                    <button type="submit" class="btn" style="padding: 4px 12px; font-size: 0.75rem; border-radius: 4px; display: flex; align-items: center; gap: 4px; background: {{ has_voted ? 'var(--pt-red)' : 'transparent' }}; border: 1px solid var(--pt-red); color: {{ has_voted ? 'white' : 'var(--pt-red)' }};">
                                        <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M12 21c-.5 0-1-.2-1.4-.6l-8.5-8.4C.7 10.6.7 8.3 2.1 6.9c1.4-1.4 3.7-1.4 5.1 0l3.4 3.4c.1.1.3.1.4 0l3.4-3.4c1.4-1.4 3.7-1.4 5.1 0 1.4 1.4 1.4 3.7 0 5.1l-8.5 8.4c-.4.4-.9.6-1.4.6z"/></svg>
                                        {{ has_voted ? 'Voted' : 'Upvote' }}
                                    </button>
                                </form>
                            {% else %}
                                <a href="{{ path('app_login') }}" style="font-size: 0.75rem; color: #888; text-decoration: underline;">Login to vote</a>
                            {% endif %}
                        </div>
                    </div>
                {% else %}
                    <p style="color: #888; font-style: italic;">No items currently planned.</p>
                {% endfor %}
            </div>

            {# In Progress Column #}
            <div class="roadmap-column">
                <h2 style="font-size: 1.5rem; border-bottom: 4px solid var(--pt-red); padding-bottom: 12px; margin-bottom: 24px; color: var(--pt-black);">In Progress</h2>
                {% for item in items|filter(i => i.status == 'in-progress') %}
                    <div class="card" style="margin-bottom: 24px; border-left: 4px solid var(--pt-red); background: rgba(255, 0, 60, 0.02); position: relative;">
                        <div class="badge badge-status-active" style="position: absolute; top: 12px; right: 12px; font-size: 0.65rem;">ACTIVE</div>
                        <h4 style="margin: 0; color: var(--pt-black);">{{ item.title }}</h4>
                        {% if item.description %}
                            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 12px; margin-bottom: 0;">{{ item.description }}</p>
                        {% endif %}

                        <div style="margin-top: 16px; display: flex; align-items: center; justify-content: space-between;">
                            <div style="font-size: 0.85rem; color: #888; display: flex; align-items: center; gap: 4px;">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
                                <span>{{ item.votes|length }} votes</span>
                            </div>
                            
                            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                                <form action="{{ path('app_roadmap_vote', {id: item.id}) }}" method="POST" style="margin: 0;">
                                    {% set has_voted = app.user in item.votes %}
                                    <button type="submit" class="btn" style="padding: 4px 12px; font-size: 0.75rem; border-radius: 4px; display: flex; align-items: center; gap: 4px; background: {{ has_voted ? 'var(--pt-red)' : 'transparent' }}; border: 1px solid var(--pt-red); color: {{ has_voted ? 'white' : 'var(--pt-red)' }};">
                                        <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M12 21c-.5 0-1-.2-1.4-.6l-8.5-8.4C.7 10.6.7 8.3 2.1 6.9c1.4-1.4 3.7-1.4 5.1 0l3.4 3.4c.1.1.3.1.4 0l3.4-3.4c1.4-1.4 3.7-1.4 5.1 0 1.4 1.4 1.4 3.7 0 5.1l-8.5 8.4c-.4.4-.9.6-1.4.6z"/></svg>
                                        {{ has_voted ? 'Voted' : 'Upvote' }}
                                    </button>
                                </form>
                            {% else %}
                                <a href="{{ path('app_login') }}" style="font-size: 0.75rem; color: #888; text-decoration: underline;">Login to vote</a>
                            {% endif %}
                        </div>
                    </div>
                {% else %}
                    <p style="color: #888; font-style: italic;">Nothing currently in development.</p>
                {% endfor %}
            </div>

            {# Completed Column #}
            <div class="roadmap-column">
                <h2 style="font-size: 1.5rem; border-bottom: 4px solid #2E7D32; padding-bottom: 12px; margin-bottom: 24px; color: var(--pt-black);">Completed</h2>
                {% for item in items|filter(i => i.status == 'completed') %}
                    <div class="card" style="margin-bottom: 24px; border-left: 4px solid #2E7D32; opacity: 0.8;">
                        <svg style="position: absolute; top: 12px; right: 12px;" width="16" height="16" viewBox="0 0 16 16" fill="#2E7D32">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                        </svg>
                        <h4 style="margin: 0; color: var(--pt-black); text-decoration: line-through; opacity: 0.6;">{{ item.title }}</h4>
                        {% if item.description %}
                            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 12px; margin-bottom: 0;">{{ item.description }}</p>
                        {% endif %}
                    </div>
                {% else %}
                    <p style="color: #888; font-style: italic;">We're just getting started!</p>
                {% endfor %}
            </div>

        </div>
    </div>
</div>
{% endblock %}
