{% extends 'base.html.twig' %}

{% block title %}{{ product.title|default('Launcher') }} - {{ site_setting('launcher_about_btn', 'Overview') }}{% endblock %}

{% block body %}
  {% if product is defined and product %}
      <div class="hero" style="text-align: center; padding: 60px 0; margin-bottom: 40px; border-bottom: 4px solid var(--pt-red);">
        <div class="container">
            <h1 style="color: white; font-size: 3.5rem; margin-bottom: 20px;">{{ product.title }}</h1>
            <p style="font-size: 1.5rem; color: var(--pt-gray-300); max-width: 700px; margin: 0 auto 30px;">
                {{ product.summary }}
            </p>
            
            {% if product.version %}
                <div style="margin-bottom: 40px;">
                    <span style="background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); padding: 6px 16px; border-radius: 4px; font-weight: bold; font-family: monospace;">v{{ product.version }}</span>
                    {% if product.productStatus %}
                        {% set statusColor = product.productStatus == 'active' ? '#4CAF50' : (product.productStatus == 'deprecated' ? '#FFC107' : '#F44336') %}
                        <span style="display: inline-flex; align-items: center; gap: 8px; padding: 6px 16px; border-radius: 4px; background: rgba(0,0,0,0.2); color: white; font-weight: 500; margin-left: 12px; border: 1px solid rgba(255,255,255,0.1);">
                            <span style="width: 10px; height: 10px; border-radius: 50%; background-color: {{ statusColor }}; box-shadow: 0 0 8px {{ statusColor }};"></span>
                            {{ product.productStatus|capitalize }}
                        </span>
                    {% endif %}
                </div>
            {% endif %}

            <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                {% if product.productType == 'software' %}
                    {% if is_licensed %}
                        <a href="{{ path('app_product_download', {'slug': product.slug}) }}" class="btn btn-primary" style="padding: 14px 40px; font-size: 1.2rem;">{{ site_setting('launcher_download_btn', 'Download Now') }} &darr;</a>
                    {% else %}
                        {# License required and not owned #}
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                            <a href="{{ path('app_checkout', {slug: product.slug}) }}" class="btn btn-primary" style="padding: 14px 40px; font-size: 1.2rem; background: #FF9800; border-color: #F57C00;">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>
                                Acquire License {% if product.price %}(${{ product.price }}){% endif %}
                            </a>
                            <p style="font-size: 0.85rem; color: #FF9800; font-weight: 500;">Valid authentication required to download</p>
                        </div>
                    {% endif %}
                {% endif %}
                
                <a href="{{ path('app_product_news_list', {'slug': product.slug}) }}" class="btn btn-secondary" style="background: transparent; border-color: white; color: white; padding: 14px 40px; font-size: 1.2rem;">{{ site_setting('launcher_news_btn', 'News') }}</a>
                
                <a href="{{ path('app_product_about', {'slug': product.slug}) }}" class="btn btn-secondary" style="background: transparent; border-color: white; color: white; padding: 14px 40px; font-size: 1.2rem;">{{ site_setting('launcher_about_btn', 'About') }}</a>
            </div>
        </div>
      </div>

      <div class="container">
          {% if product.imageUrl %}
            <div style="text-align: center; margin-bottom: 80px;">
                <img src="{{ product.imageUrl }}" alt="{{ product.title }} Screenshot" style="max-width: 100%; border-radius: 4px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); border: 1px solid #eee;">
            </div>
          {% endif %}

          <div style="max-width: 900px; margin: 0 auto;">
              {% if product.description %}
                <div class="prose" style="margin-bottom: 80px;">
                    {{ product.description|markdown_to_html|raw }}
                </div>
              {% endif %}

              {% if product.features is not empty %}
                  <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); margin-bottom: 80px;">
                    {% for feature in product.features %}
                        <div class="card" style="border-top: 4px solid var(--pt-red);">
                            <h3 style="margin-top: 0; font-size: 1.2rem;">{{ feature|split(':')|first }}</h3>
                            <p style="margin-bottom: 0;">{{ feature|split(':')|last }}</p>
                        </div>
                    {% endfor %}
                  </div>
              {% endif %}
          </div>
      </div>
  {% else %}
      <div style="text-align: center; padding: 60px;">
          <h1>{{ site_setting('launcher_not_found_title', 'Product Not Found') }}</h1>
          <p>{{ site_setting('launcher_not_found_body', 'The requested product could not be loaded.') }}</p>
          <a href="{{ path('app_home') }}" class="btn btn-primary">{{ site_setting('launcher_go_home_btn', 'Go Home') }}</a>
      </div>
  {% endif %}
{% endblock %}
