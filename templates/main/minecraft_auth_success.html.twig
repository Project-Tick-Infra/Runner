{% extends 'base.html.twig' %}

{% block title %}Minecraft Authentication Success - Project Tick{% endblock %}

{% block body %}
<div class="hero-section" style="background: linear-gradient(135deg, #050505 0%, #1a1a1a 100%);">
    <div class="container text-center">
        <div class="badge badge-status-active mb-3">SUCCESS</div>
        <h1 style="color: white; font-size: 3.5rem;">Minecraft Linked Successfully</h1>
        <p class="lead" style="color: var(--pt-gray-300);">Your Microsoft account has been authenticated and linked to Project Tick.</p>
    </div>
</div>

<div class="container py-5">
    <div class="card" style="max-width: 800px; margin: 0 auto; padding: 40px;">
        <div style="display: flex; align-items: center; gap: 30px; margin-bottom: 40px;">
            <div style="width: 100px; height: 100px; background: #222; border-radius: 12px; overflow: hidden; display: flex; align-items: center; justify-content: center;">
                {% if data.uuid %}
                    <img src="https://mc-heads.net/avatar/{{ data.uuid }}/100" alt="Minecraft Avatar" style="width: 100%; height: 100%; object-fit: contain;">
                {% else %}
                    <div style="color: white; font-size: 2rem;">MC</div>
                {% endif %}
            </div>
            <div>
                <h3 style="margin: 0;">{{ data.username }}</h3>
                <p style="color: var(--text-secondary); margin: 5px 0 0 0;">{{ data.uuid }}</p>
                {% if data.owns_game %}
                    <div style="display: flex; align-items: center; gap: 8px; color: #2E7D32; font-weight: 700; margin-top: 10px; font-size: 0.9rem;">
                        <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor"><path d="M0 11l2-2 5 5L18 3l2 2L7 18z"/></svg>
                        Minecraft Java Edition Owned
                    </div>
                {% else %}
                    <div style="display: flex; align-items: center; gap: 8px; color: var(--pt-red); font-weight: 700; margin-top: 10px; font-size: 0.9rem;">
                        <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor"><path d="M10 0C4.48 0 0 4.48 0 10s4.48 10 10 10 10-4.48 10-10S15.52 0 10 0zm1 15H9v-2h2v2zm0-4H9V5h2v6z"/></svg>
                        Game Not Found in Entitlements
                    </div>
                {% endif %}
            </div>
        </div>

        <div style="background: var(--pt-gray-100); padding: 24px; border-radius: 12px; border: 1px solid var(--border-color);">
            <h5 style="margin-top: 0; margin-bottom: 15px; color: var(--text-secondary); text-transform: uppercase; font-size: 0.8rem; letter-spacing: 0.1em;">Launcher Access Token</h5>
            <div style="position: relative;">
                <code id="access-token" style="display: block; word-break: break-all; background: white; padding: 15px; border-radius: 8px; border: 1px solid #ddd; font-family: monospace; font-size: 0.9rem;">{{ data.minecraft_token }}</code>
                <button onclick="copyToken()" class="btn btn-ghost" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); padding: 5px 10px; font-size: 0.8rem;">Copy</button>
            </div>
            <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 15px; margin-bottom: 0;">
                <svg width="12" height="12" viewBox="0 0 20 20" fill="currentColor" style="margin-right: 4px;"><path d="M10 20C4.477 20 0 15.523 0 10S4.477 0 10 0s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 100-16 8 8 0 000 16zM9 11V5h2v6H9zm0 4v-2h2v2H9z"/></svg>
                This token allows ProjT Launcher to log you into Minecraft. Keep it secret.
            </p>
        </div>

        <div style="margin-top: 40px; display: flex; gap: 15px;">
            <a href="{{ path('app_home') }}" class="btn btn-primary" style="flex: 1; text-align: center;">Go to Home</a>
            <a href="{{ path('connect_microsoft_start') }}" class="btn btn-secondary" style="flex: 1; text-align: center;">Re-authenticate</a>
        </div>
    </div>
</div>

<script>
function copyToken() {
    const token = document.getElementById('access-token').innerText;
    navigator.clipboard.writeText(token).then(() => {
        alert('Token copied to clipboard!');
    });
}
</script>
{% endblock %}
